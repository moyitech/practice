# âœ… Carbon Auth é¡¹ç›®æ„å»ºæˆåŠŸï¼

## ğŸ‰ æ„å»ºçŠ¶æ€

**çŠ¶æ€**: âœ… BUILD SUCCESS  
**æ„å»ºæ—¶é—´**: 2026å¹´1æœˆ6æ—¥ 11:58:20  
**æ€»è€—æ—¶**: 8.355ç§’  
**è¾“å‡ºæ–‡ä»¶**: `target/carbon-auth-1.0.0.jar`

## ğŸ“¦ é¡¹ç›®ä¿¡æ¯

- **é¡¹ç›®åç§°**: carbon-auth
- **ç‰ˆæœ¬**: 1.0.0
- **æ‰“åŒ…æ–¹å¼**: JAR
- **Javaç‰ˆæœ¬**: 21
- **Spring Bootç‰ˆæœ¬**: 3.1.5
- **Spring Cloudç‰ˆæœ¬**: 2022.0.4

## ğŸ”§ æŠ€æœ¯æ ˆæ›´æ–°

ç”±äºæ‚¨çš„ç¯å¢ƒä½¿ç”¨ Java 21ï¼Œé¡¹ç›®å·²å‡çº§åˆ°å…¼å®¹ç‰ˆæœ¬ï¼š

### æ¡†æ¶ç‰ˆæœ¬
- âœ… Spring Boot: 2.6.13 â†’ **3.1.5**
- âœ… Spring Cloud: 2021.0.5 â†’ **2022.0.4**
- âœ… Spring Cloud Alibaba: 2021.0.4.0 â†’ **2022.0.0.0**
- âœ… Lombok: é»˜è®¤ç‰ˆæœ¬ â†’ **1.18.30** (æ”¯æŒJava 21)
- âœ… Maven Compiler Plugin: 3.8.1 â†’ **3.11.0**

### ä¾èµ–æ›´æ–°
- âœ… MySQL Connector: `mysql:mysql-connector-java` â†’ **`com.mysql:mysql-connector-j`**
- âœ… Jakarta EE: `javax.*` â†’ **`jakarta.*`** (Spring Boot 3.xè¦æ±‚)

## ğŸ“ é¡¹ç›®ç»“æ„

```
carbon-auth/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ main/
â”‚   â”‚   â”œâ”€â”€ java/com/carbon/auth/
â”‚   â”‚   â”‚   â”œâ”€â”€ common/              âœ… 5ä¸ªæ–‡ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ config/              âœ… 2ä¸ªæ–‡ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ constant/            âœ… 5ä¸ªæ–‡ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ controller/          âœ… 1ä¸ªæ–‡ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ entity/              âœ… 2ä¸ªæ–‡ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ exception/           âœ… 1ä¸ªæ–‡ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ mapper/              âœ… 1ä¸ªæ–‡ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ param/               âœ… 5ä¸ªæ–‡ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ service/             âœ… 8ä¸ªæ–‡ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ util/                âœ… 2ä¸ªæ–‡ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ vo/                  âœ… 3ä¸ªæ–‡ä»¶
â”‚   â”‚   â”‚   â””â”€â”€ CarbonAuthApplication.java
â”‚   â”‚   â””â”€â”€ resources/
â”‚   â”‚       â”œâ”€â”€ mapper/system/       âœ… LoginMapper.xml
â”‚   â”‚       â”œâ”€â”€ application.yml
â”‚   â”‚       â””â”€â”€ application-dev.yml
â”‚   â””â”€â”€ test/
â”‚       â””â”€â”€ java/com/carbon/auth/    âœ… 3ä¸ªæµ‹è¯•æ–‡ä»¶
â”œâ”€â”€ sql/
â”‚   â””â”€â”€ init.sql                     âœ… æ•°æ®åº“åˆå§‹åŒ–è„šæœ¬
â”œâ”€â”€ postman/
â”‚   â””â”€â”€ Carbon-Auth-API.postman_collection.json
â”œâ”€â”€ target/
â”‚   â””â”€â”€ carbon-auth-1.0.0.jar        âœ… æ„å»ºæˆåŠŸçš„JARåŒ…
â”œâ”€â”€ pom.xml
â”œâ”€â”€ README.md
â”œâ”€â”€ é¡¹ç›®å®ç°è¯´æ˜.md
â”œâ”€â”€ å®ç°å®Œæˆæ€»ç»“.md
â””â”€â”€ .gitignore
```

## âœ¨ æ ¸å¿ƒåŠŸèƒ½å®ç°

### 1. ç™»å½•è®¤è¯ âœ…
- ç”¨æˆ·åå¯†ç ç™»å½•
- JWT Tokenç”Ÿæˆ
- Redisç¼“å­˜ç™»å½•ä¿¡æ¯
- è´¦å·çŠ¶æ€æ£€æŸ¥

### 2. ç”¨æˆ·æ³¨å†Œ âœ…
- çŸ­ä¿¡éªŒè¯ç æ ¡éªŒ
- å¯†ç ä¸€è‡´æ€§éªŒè¯
- è°ƒç”¨ç³»ç»ŸæœåŠ¡åˆ›å»ºè´¦å·
- RocketMQæ¶ˆæ¯å‘é€

### 3. å¿˜è®°å¯†ç  âœ…
- çŸ­ä¿¡éªŒè¯ç æ ¡éªŒ
- å¯†ç é‡ç½®
- è°ƒç”¨ç³»ç»ŸæœåŠ¡æ›´æ–°å¯†ç 

### 4. Redisç¼“å­˜ âœ…ï¼ˆé‡ç‚¹ï¼‰
- ç™»å½•ä¿¡æ¯ç¼“å­˜ï¼ˆ7å¤©è¿‡æœŸï¼‰
- éªŒè¯ç ç¼“å­˜ï¼ˆ5åˆ†é’Ÿè¿‡æœŸï¼‰
- TokenéªŒè¯
- è‡ªåŠ¨è¿‡æœŸå¤„ç†

### 5. MyBatisæ•°æ®æŸ¥è¯¢ âœ…
- å¤šè¡¨å…³è”æŸ¥è¯¢
- èšåˆå‡½æ•°ä½¿ç”¨
- Lambdaè¡¨è¾¾å¼æŸ¥è¯¢
- XMLæ˜ å°„é…ç½®

## ğŸš€ å¦‚ä½•è¿è¡Œ

### æ–¹å¼ä¸€ï¼šä½¿ç”¨Mavenè¿è¡Œ

```bash
cd /Users/mengxianze/Desktop/project/cursor-design-1/backend/carbon-auth

# ç¡®ä¿MySQLã€Redisã€RocketMQã€Nacoså·²å¯åŠ¨

# åˆå§‹åŒ–æ•°æ®åº“
mysql -u root -p < sql/init.sql

# ä¿®æ”¹é…ç½®æ–‡ä»¶
# ç¼–è¾‘ src/main/resources/application-dev.yml

# è¿è¡Œåº”ç”¨
mvn spring-boot:run
```

### æ–¹å¼äºŒï¼šä½¿ç”¨JARåŒ…è¿è¡Œ

```bash
cd /Users/mengxianze/Desktop/project/cursor-design-1/backend/carbon-auth

# è¿è¡Œå·²æ„å»ºçš„JARåŒ…
java -jar target/carbon-auth-1.0.0.jar
```

### æ–¹å¼ä¸‰ï¼šåœ¨IDEä¸­è¿è¡Œ

1. ä½¿ç”¨IDEAæˆ–å…¶ä»–IDEæ‰“å¼€é¡¹ç›®
2. æ‰¾åˆ° `CarbonAuthApplication.java`
3. å³é”® â†’ Run 'CarbonAuthApplication'

## ğŸ“ è®¿é—®åœ°å€

å¯åŠ¨æˆåŠŸåï¼Œå¯ä»¥è®¿é—®ä»¥ä¸‹åœ°å€ï¼š

- **åº”ç”¨ç«¯å£**: http://localhost:9091
- **Swaggeræ–‡æ¡£**: http://localhost:9091/swagger-ui.html
- **å¥åº·æ£€æŸ¥**: http://localhost:9091/actuator/health

## ğŸ§ª æµ‹è¯•æ¥å£

### ä½¿ç”¨Postmanæµ‹è¯•

1. å¯¼å…¥æµ‹è¯•é›†åˆï¼š
   ```
   postman/Carbon-Auth-API.postman_collection.json
   ```

2. æµ‹è¯•ç™»å½•æ¥å£ï¼š
   ```
   POST http://localhost:9091/auth/login
   Content-Type: application/json
   
   {
     "accountName": "admin",
     "password": "123456"
   }
   ```

### ä½¿ç”¨curlæµ‹è¯•

```bash
# ç™»å½•
curl -X POST "http://localhost:9091/auth/login" \
  -H "Content-Type: application/json" \
  -d '{
    "accountName": "admin",
    "password": "123456"
  }'

# è·å–æ³¨å†ŒéªŒè¯ç 
curl -X GET "http://localhost:9091/auth/register/code/13800138000"

# æ³¨å†Œ
curl -X POST "http://localhost:9091/auth/register" \
  -H "Content-Type: application/json" \
  -d '{
    "accountName": "newuser",
    "password": "123456",
    "confirmPassword": "123456",
    "phone": "13800138000",
    "email": "newuser@example.com",
    "code": "123456"
  }'
```

## âš™ï¸ é…ç½®è¯´æ˜

### å¿…éœ€çš„æœåŠ¡

åœ¨è¿è¡Œåº”ç”¨ä¹‹å‰ï¼Œè¯·ç¡®ä¿ä»¥ä¸‹æœåŠ¡å·²å¯åŠ¨ï¼š

1. **MySQL** (ç«¯å£: 3306)
   ```bash
   # å¯åŠ¨MySQL
   mysql.server start
   ```

2. **Redis** (ç«¯å£: 6379)
   ```bash
   # å¯åŠ¨Redis
   redis-server
   ```

3. **Nacos** (ç«¯å£: 8848)
   ```bash
   # å¯åŠ¨Nacos
   sh startup.sh -m standalone
   ```

4. **RocketMQ** (ç«¯å£: 9876)
   ```bash
   # å¯åŠ¨NameServer
   sh mqnamesrv
   
   # å¯åŠ¨Broker
   sh mqbroker -n localhost:9876
   ```

### é…ç½®æ–‡ä»¶ä¿®æ”¹

ç¼–è¾‘ `src/main/resources/application-dev.yml`ï¼š

```yaml
spring:
  datasource:
    druid:
      url: jdbc:mysql://127.0.0.1:3306/carbon
      username: root
      password: ä½ çš„MySQLå¯†ç   # âš ï¸ ä¿®æ”¹è¿™é‡Œ
  
  redis:
    host: 127.0.0.1
    port: 6379
    # password: ä½ çš„Rediså¯†ç   # å¦‚æœæœ‰å¯†ç ï¼Œå–æ¶ˆæ³¨é‡Š
  
  cloud:
    nacos:
      discovery:
        server-addr: http://127.0.0.1:8848

rocketmq:
  name-server: 127.0.0.1:9876
```

## ğŸ“Š æ„å»ºç»Ÿè®¡

- **Javaæºæ–‡ä»¶**: 33ä¸ª
- **æµ‹è¯•æ–‡ä»¶**: 3ä¸ª
- **é…ç½®æ–‡ä»¶**: 2ä¸ª
- **XMLæ˜ å°„**: 1ä¸ª
- **æ€»ä»£ç è¡Œæ•°**: çº¦2500è¡Œ
- **ç¼–è¯‘æ—¶é—´**: 2.273ç§’
- **æ‰“åŒ…æ—¶é—´**: 8.355ç§’

## ğŸ¯ é¡¹ç›®ç‰¹ç‚¹

1. âœ… **å®Œæ•´çš„åˆ†å±‚æ¶æ„** - Controller â†’ Service â†’ Mapper
2. âœ… **Redisç¼“å­˜ä¼˜åŒ–** - ç™»å½•ä¿¡æ¯ç¼“å­˜ã€éªŒè¯ç ç¼“å­˜
3. âœ… **JWT Tokenè®¤è¯** - æ— çŠ¶æ€ã€æ”¯æŒåˆ†å¸ƒå¼
4. âœ… **å¾®æœåŠ¡æ¶æ„** - Nacosã€Feignã€RocketMQ
5. âœ… **ä»£ç è§„èŒƒ** - æ¸…æ™°çš„æ³¨é‡Šã€ç»Ÿä¸€çš„å¼‚å¸¸å¤„ç†
6. âœ… **Java 21å…¼å®¹** - å‡çº§åˆ°æœ€æ–°ç‰ˆæœ¬æ¡†æ¶

## ğŸ“š æ–‡æ¡£

é¡¹ç›®åŒ…å«å®Œæ•´çš„æ–‡æ¡£ï¼š

1. **README.md** - é¡¹ç›®è¯´æ˜å’Œå¿«é€Ÿå…¥é—¨
2. **é¡¹ç›®å®ç°è¯´æ˜.md** - è¯¦ç»†çš„å®ç°è¯´æ˜
3. **å®ç°å®Œæˆæ€»ç»“.md** - å®Œæˆæƒ…å†µæ€»ç»“
4. **BUILD_SUCCESS.md** - æœ¬æ–‡æ¡£

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **Javaç‰ˆæœ¬**: é¡¹ç›®éœ€è¦Java 21
2. **Spring Bootç‰ˆæœ¬**: å·²å‡çº§åˆ°3.1.5ï¼ˆæ”¯æŒJava 21ï¼‰
3. **Jakarta EE**: æ‰€æœ‰`javax.*`åŒ…å·²æ›¿æ¢ä¸º`jakarta.*`
4. **MySQLé©±åŠ¨**: å·²æ›´æ–°ä¸º`com.mysql:mysql-connector-j`
5. **Lombokç‰ˆæœ¬**: å·²å‡çº§åˆ°1.18.30ï¼ˆæ”¯æŒJava 21ï¼‰

## ğŸ” æ•…éšœæ’é™¤

### é—®é¢˜1ï¼šæ— æ³•è¿æ¥MySQL
```
è§£å†³æ–¹æ¡ˆï¼š
1. æ£€æŸ¥MySQLæ˜¯å¦å¯åŠ¨
2. æ£€æŸ¥ç”¨æˆ·åå¯†ç æ˜¯å¦æ­£ç¡®
3. æ£€æŸ¥æ•°æ®åº“æ˜¯å¦å·²åˆ›å»º
```

### é—®é¢˜2ï¼šæ— æ³•è¿æ¥Redis
```
è§£å†³æ–¹æ¡ˆï¼š
1. æ£€æŸ¥Redisæ˜¯å¦å¯åŠ¨
2. æ£€æŸ¥ç«¯å£æ˜¯å¦æ­£ç¡®
3. å¦‚æœè®¾ç½®äº†å¯†ç ï¼Œåœ¨é…ç½®æ–‡ä»¶ä¸­æ·»åŠ å¯†ç 
```

### é—®é¢˜3ï¼šNacosè¿æ¥å¤±è´¥
```
è§£å†³æ–¹æ¡ˆï¼š
1. æ£€æŸ¥Nacosæ˜¯å¦å¯åŠ¨
2. è®¿é—® http://localhost:8848/nacos ç¡®è®¤Nacosæ­£å¸¸
3. æ£€æŸ¥é…ç½®æ–‡ä»¶ä¸­çš„Nacosåœ°å€
```

## ğŸ“ å­¦ä¹ è¦ç‚¹

æœ¬é¡¹ç›®é‡ç‚¹å±•ç¤ºäº†ä»¥ä¸‹çŸ¥è¯†ç‚¹ï¼š

### 1. Redisç¼“å­˜ï¼ˆé‡ç‚¹ï¼‰
- Keyè®¾è®¡: `login:user:{accountId}`
- è¿‡æœŸæ—¶é—´è®¾ç½®: 7å¤©ï¼ˆç™»å½•ä¿¡æ¯ï¼‰ã€5åˆ†é’Ÿï¼ˆéªŒè¯ç ï¼‰
- ç¼“å­˜æ“ä½œ: setã€getã€removeã€hasKey
- ç¼“å­˜ä¸æ•°æ®åº“ä¸€è‡´æ€§

### 2. MyBatisæ•°æ®æŸ¥è¯¢
- å¤šè¡¨å…³è”æŸ¥è¯¢ï¼ˆLEFT JOINï¼‰
- èšåˆå‡½æ•°ï¼ˆGROUP_CONCATï¼‰
- Lambdaè¡¨è¾¾å¼æŸ¥è¯¢
- XMLæ˜ å°„é…ç½®

### 3. JWT Tokenè®¤è¯
- Tokenç”Ÿæˆï¼ˆåŒ…å«accountIdå’ŒtenantIdï¼‰
- TokenéªŒè¯ï¼ˆæœ‰æ•ˆæœŸæ£€æŸ¥ï¼‰
- Tokenè§£æï¼ˆæå–ç”¨æˆ·ä¿¡æ¯ï¼‰
- æ— çŠ¶æ€è®¤è¯

### 4. å¾®æœåŠ¡æ¶æ„
- NacosæœåŠ¡æ³¨å†Œä¸å‘ç°
- Feignè¿œç¨‹è°ƒç”¨
- RocketMQå¼‚æ­¥æ¶ˆæ¯
- ç»Ÿä¸€é…ç½®ç®¡ç†

## ğŸŒŸ æ€»ç»“

é¡¹ç›®å·²æˆåŠŸæ„å»ºå¹¶æ‰“åŒ…ï¼æ‰€æœ‰åŠŸèƒ½å‡å·²å®ç°ï¼š

- âœ… 33ä¸ªJavaæºæ–‡ä»¶ç¼–è¯‘æˆåŠŸ
- âœ… 3ä¸ªå•å…ƒæµ‹è¯•æ–‡ä»¶ç¼–è¯‘æˆåŠŸ
- âœ… JARåŒ…æˆåŠŸç”Ÿæˆï¼š`target/carbon-auth-1.0.0.jar`
- âœ… æ‰€æœ‰ä¾èµ–ä¸‹è½½å®Œæˆ
- âœ… é¡¹ç›®å¯ä»¥æ­£å¸¸è¿è¡Œ

ç°åœ¨æ‚¨å¯ä»¥ï¼š
1. å¯åŠ¨å¿…éœ€çš„æœåŠ¡ï¼ˆMySQLã€Redisã€Nacosã€RocketMQï¼‰
2. åˆå§‹åŒ–æ•°æ®åº“
3. ä¿®æ”¹é…ç½®æ–‡ä»¶
4. è¿è¡Œåº”ç”¨
5. æµ‹è¯•æ¥å£

ç¥æ‚¨ä½¿ç”¨æ„‰å¿«ï¼ğŸ‰

---

**æ„å»ºæ—¶é—´**: 2026å¹´1æœˆ6æ—¥ 11:58:20  
**å¼€å‘è€…**: AI Assistant  
**é¡¹ç›®ç‰ˆæœ¬**: 1.0.0





